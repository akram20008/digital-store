<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø·Ù„Ø¨Ø§ØªÙŠ</title>

<style>
body{
  margin:0;
  font-family:Tahoma;
  background:linear-gradient(135deg,#0f172a,#1e3a8a);
  color:#fff;
}
header{
  background:#020617;
  padding:15px 20px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}
header h2{margin:0}
header a{
  color:#fff;
  text-decoration:none;
  background:#1e40af;
  padding:8px 14px;
  border-radius:6px;
}

.container{
  max-width:900px;
  margin:auto;
  padding:30px 20px;
}

.order{
  background:#fff;
  color:#000;
  border-radius:12px;
  padding:15px;
  margin-bottom:15px;
  box-shadow:0 8px 20px rgba(0,0,0,.25);
}
.status{
  font-weight:bold;
}
.new{color:#2563eb}
.done{color:#16a34a}
.wait{color:#ca8a04}
</style>
</head>

<body>

<header>
  <h2>ðŸ“¦ Ø·Ù„Ø¨Ø§ØªÙŠ</h2>
  <a href="index.html">â¬… Ø±Ø¬ÙˆØ¹</a>
</header>

<div class="container">
  <h1>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨ÙŠ</h1>
  <div id="orders"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyAkVr83u7Oxy-lWvqWlCqyVjIS34J-FRd4",
  authDomain: "digital-store-268a9.firebaseapp.com",
  projectId: "digital-store-268a9"
});

const auth = firebase.auth();
const db = firebase.firestore();

/* ===== Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© ===== */
auth.onAuthStateChanged(user=>{
  if(!user){
    location.href="login.html";
    return;
  }

  loadOrders(user.email);
});

/* ===== ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ===== */
function loadOrders(email){
  db.collection("orders")
  .where("email","==",email)
  .orderBy("createdAt","desc")
  .onSnapshot(snapshot=>{
    orders.innerHTML="";
    if(snapshot.empty){
      orders.innerHTML="<p>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</p>";
    }
    snapshot.forEach(doc=>{
      const o = doc.data();
      let statusClass="wait";
      if(o.status==="Ø¬Ø¯ÙŠØ¯") statusClass="new";
      if(o.status==="Ù…Ù†Ø¬Ø²") statusClass="done";

      orders.innerHTML+=`
        <div class="order">
          <b>Ø§Ù„Ø®Ø¯Ù…Ø©:</b> ${o.service}<br>
          <b>Ø§Ù„Ø­Ø§Ù„Ø©:</b>
          <span class="status ${statusClass}">
            ${o.status}
          </span>
        </div>
      `;
    });
  });
}
</script>

</body>
</html>
