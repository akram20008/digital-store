<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø·Ù„Ø¨Ø§ØªÙŠ</title>

<style>
body{
  margin:0;
  font-family:Tajawal,Tahoma;
  background:#020617;
  color:#fff;
}

.container{
  max-width:900px;
  margin:40px auto;
  padding:20px;
}

.top-bar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:25px;
}

.back-btn{
  background:linear-gradient(135deg,#2563eb,#1e40af);
  border:none;
  color:#fff;
  padding:10px 16px;
  border-radius:14px;
  cursor:pointer;
  font-size:14px;
  transition:.3s;
}

.back-btn:hover{
  transform:scale(1.05);
  box-shadow:0 0 25px rgba(37,99,235,.7);
}

h2{
  text-align:center;
  margin:0;
}

.orders{
  display:grid;
  gap:20px;
}

.order{
  background:linear-gradient(160deg,rgba(255,255,255,.18),rgba(255,255,255,.05));
  backdrop-filter:blur(18px);
  border-radius:20px;
  padding:20px;
  box-shadow:0 20px 60px rgba(0,0,0,.5);
  animation:fadeUp .6s ease;
}

@keyframes fadeUp{
  from{opacity:0;transform:translateY(30px)}
  to{opacity:1;transform:none}
}

.order div{
  margin:6px 0;
  font-size:14px;
}

.status{
  display:inline-block;
  padding:6px 12px;
  border-radius:12px;
  font-size:13px;
  margin-top:8px;
}

.pending{background:#facc15;color:#000}
.review{background:#38bdf8;color:#000}
.done{background:#22c55e;color:#000}
.rejected{background:#dc2626}

.order img{
  width:120px;
  border-radius:12px;
  margin-top:12px;
  display:block;
}
</style>
</head>

<body>

<div class="container">

  <!-- TOP BAR -->
  <div class="top-bar">
    <button class="back-btn" onclick="location.href='index.html'">
      ğŸ›’ Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù…ØªØ¬Ø±
    </button>
    <h2>ğŸ“¦ Ø·Ù„Ø¨Ø§ØªÙŠ</h2>
    <div></div>
  </div>

  <div class="orders" id="orders"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyAkVr83u7Oxy-lWvqWlCqyVjIS34J-FRd4",
  authDomain:"digital-store-268a9.firebaseapp.com",
  projectId:"digital-store-268a9"
});

const auth = firebase.auth();
const db = firebase.firestore();
const ordersDiv = document.getElementById("orders");

auth.onAuthStateChanged(user=>{
  if(!user){
    location.href="login.html";
    return;
  }

  db.collection("orders")
    .where("email","==",user.email)
    .orderBy("createdAt","desc")
    .onSnapshot(snap=>{
      ordersDiv.innerHTML="";
      if(snap.empty){
        ordersDiv.innerHTML="<p style='text-align:center'>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯</p>";
      }
      snap.forEach(doc=>{
        const o = doc.data();

        let statusClass="pending";
        if(o.status==="Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©") statusClass="review";
        if(o.status==="Ù…ÙƒØªÙ…Ù„") statusClass="done";
        if(o.status==="Ù…Ø±ÙÙˆØ¶") statusClass="rejected";

        ordersDiv.innerHTML+=`
          <div class="order">
            <div>ğŸ›’ Ø§Ù„Ø®Ø¯Ù…Ø©: <b>${o.service}</b></div>
            <div>ğŸ’° Ø§Ù„Ø³Ø¹Ø±: $ ${o.price}</div>
            <div>ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹: ${o.paymentMethod}</div>
            <div class="status ${statusClass}">${o.status}</div>
            ${o.proofImage ? `<img src="${o.proofImage}">` : ""}
          </div>
        `;
      });
    });
});
</script>

</body>
  </html>
