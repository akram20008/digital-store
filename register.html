<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>إنشاء حساب</title>

<style>
body{
  margin:0;
  font-family:Tajawal,Tahoma;
  background:radial-gradient(circle at top,#1e3a8a,#020617 70%);
  color:#fff;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
}

.box{
  width:95%;
  max-width:420px;
  background:rgba(255,255,255,.12);
  backdrop-filter:blur(16px);
  padding:30px;
  border-radius:24px;
  box-shadow:0 30px 80px rgba(0,0,0,.7);
  animation:pop .8s ease;
}

@keyframes pop{
  from{opacity:0;transform:scale(.8) translateY(40px)}
  to{opacity:1;transform:none}
}

h2{text-align:center;margin-bottom:25px}

input{
  width:100%;
  padding:13px;
  border:none;
  border-radius:14px;
  margin-bottom:12px;
  outline:none;
}

.check{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:13px;
  margin:10px 0;
}

button{
  width:100%;
  padding:13px;
  border:none;
  border-radius:16px;
  background:linear-gradient(135deg,#2563eb,#1e40af);
  color:#fff;
  font-size:16px;
  cursor:pointer;
  transition:.3s;
}
button:hover{transform:scale(1.05)}

.link{text-align:center;margin-top:15px;font-size:13px}
.link a{color:#60a5fa;text-decoration:none}

/* Modal */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.6);
  display:flex;
  justify-content:center;
  align-items:center;
  opacity:0;
  pointer-events:none;
  transition:.4s;
}
.modal.show{opacity:1;pointer-events:auto}

.modal-box{
  background:linear-gradient(135deg,#166534,#020617);
  padding:25px;
  border-radius:20px;
  width:90%;
  max-width:360px;
  text-align:center;
  transform:scale(.7);
  transition:.4s;
}
.modal.show .modal-box{transform:scale(1)}
</style>
</head>

<body>

<div class="box">
  <h2>✨ إنشاء حساب</h2>

  <input id="username" placeholder="اسم المستخدم">
  <input id="email" type="email" placeholder="البريد الإلكتروني">
  <input id="password" type="password" placeholder="كلمة المرور">
  <input id="password2" type="password" placeholder="تأكيد كلمة المرور">

  <div class="check">
    <input type="checkbox" id="agree">
    <label for="agree">أوافق على الشروط والأحكام</label>
  </div>

  <button onclick="register()">إنشاء الحساب</button>

  <div class="link">
    لديك حساب؟ <a href="login.html">تسجيل دخول</a>
  </div>
</div>

<div id="modal" class="modal">
  <div class="modal-box">
    <h3 id="mTitle"></h3>
    <p id="mText"></p>
    <button onclick="modal.classList.remove('show')">حسناً</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyAkVr83u7Oxy-lWvqWlCqyVjIS34J-FRd4",
  authDomain:"digital-store-268a9.firebaseapp.com",
  projectId:"digital-store-268a9"
});

const auth = firebase.auth();
const db = firebase.firestore();

const modal = document.getElementById("modal");
const mTitle = document.getElementById("mTitle");
const mText = document.getElementById("mText");

function showModal(t,txt,error=false){
  mTitle.textContent=t;
  mText.textContent=txt;
  modal.querySelector(".modal-box").style.background =
    error ? "linear-gradient(135deg,#7f1d1d,#020617)"
          : "linear-gradient(135deg,#166534,#020617)";
  modal.classList.add("show");
}

function register(){
  const username = document.getElementById("username").value.trim();
  const email    = document.getElementById("email").value.trim();
  const pass     = document.getElementById("password").value;
  const pass2    = document.getElementById("password2").value;
  const agree    = document.getElementById("agree").checked;

  if(!username||!email||!pass||!pass2)
    return showModal("خطأ ❌","جميع الحقول مطلوبة",true);

  if(pass !== pass2)
    return showModal("خطأ ❌","كلمتا المرور غير متطابقتين",true);

  if(!agree)
    return showModal("تنبيه ⚠️","يجب الموافقة على الشروط",true);

  auth.createUserWithEmailAndPassword(email,pass)
    .then(cred=>{
      return db.collection("users").doc(cred.user.uid).set({
        username,
        email,
        createdAt: firebase.firestore.FieldValue.serverTimestamp()
      });
    })
    .then(()=>{
      showModal("تم ✅","تم إنشاء الحساب بنجاح");
      setTimeout(()=>location.href="index.html",2000);
    })
    .catch(err=>{
      showModal("خطأ ❌",err.message,true);
    });
}
</script>

</body>
</html>
